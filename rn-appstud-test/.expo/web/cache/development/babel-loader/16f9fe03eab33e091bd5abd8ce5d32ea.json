{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/flo/Documents/Code/react-native/appstud/rn-appstud-test/screens/PlaylistDetailScreen.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as React from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport axios from \"axios\";\nimport { Audio } from \"expo-av\";\nvar API_ENDPOINT = \"http://localhost:3001\";\nexport default function PlaylistDetailScreen(_ref) {\n  var _track$artists$;\n\n  var route = _ref.route;\n  var id = route.params.id;\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      playlistDetail = _React$useState2[0],\n      setPlaylistDetail = _React$useState2[1];\n\n  var _React$useState3 = React.useState(),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      track = _React$useState4[0],\n      setTrack = _React$useState4[1];\n\n  var _React$useState5 = React.useState({\n    isPlaying: false,\n    playbackInstance: null,\n    volume: 1.0,\n    isBuffering: false\n  }),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      audioState = _React$useState6[0],\n      setAudioState = _React$useState6[1];\n\n  React.useEffect(function () {\n    var mounted = true;\n\n    (function _callee() {\n      var response;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(axios.get(API_ENDPOINT + \"/v1/playlists/\" + id));\n\n            case 2:\n              response = _context.sent;\n              setPlaylistDetail(response.data);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n\n    return function cleanup() {\n      mounted = false;\n    };\n  }, []);\n\n  var loadAudio = function loadAudio(soundUri) {\n    var playbackInstance;\n    return _regeneratorRuntime.async(function loadAudio$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (soundUri) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 2:\n            _context2.t0 = audioState == null ? void 0 : audioState.playbackInstance;\n\n            if (!_context2.t0) {\n              _context2.next = 6;\n              break;\n            }\n\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(audioState == null ? void 0 : audioState.playbackInstance.unloadAsync());\n\n          case 6:\n            playbackInstance = new Audio.Sound();\n            _context2.prev = 7;\n            _context2.next = 10;\n            return _regeneratorRuntime.awrap(playbackInstance.loadAsync({\n              uri: soundUri\n            }, {\n              shouldPlay: true,\n              volume: audioState.volume\n            }, false));\n\n          case 10:\n            setAudioState(_objectSpread(_objectSpread({}, audioState), {}, {\n              playbackInstance: playbackInstance,\n              isPlaying: true\n            }));\n            _context2.next = 16;\n            break;\n\n          case 13:\n            _context2.prev = 13;\n            _context2.t1 = _context2[\"catch\"](7);\n            console.log(_context2.t1);\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[7, 13]], Promise);\n  };\n\n  var handlePlayPause = function handlePlayPause() {\n    var _audioState$playbackI, _audioState$playbackI2;\n\n    return _regeneratorRuntime.async(function handlePlayPause$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(\"audioState : \", audioState);\n\n            if (!(audioState == null ? void 0 : audioState.playbackInstance)) {\n              _context3.next = 10;\n              break;\n            }\n\n            setAudioState(_objectSpread(_objectSpread({}, audioState), {}, {\n              isPlaying: !audioState.isPlaying\n            }));\n\n            if (!audioState.isPlaying) {\n              _context3.next = 8;\n              break;\n            }\n\n            _context3.next = 6;\n            return _regeneratorRuntime.awrap(audioState == null ? void 0 : (_audioState$playbackI = audioState.playbackInstance) == null ? void 0 : _audioState$playbackI.pauseAsync());\n\n          case 6:\n            _context3.next = 10;\n            break;\n\n          case 8:\n            _context3.next = 10;\n            return _regeneratorRuntime.awrap(audioState == null ? void 0 : (_audioState$playbackI2 = audioState.playbackInstance) == null ? void 0 : _audioState$playbackI2.playAsync());\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  }, playlistDetail && React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.header,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, React.createElement(Image, {\n    source: {\n      uri: playlistDetail.images[0].url\n    },\n    style: {\n      width: 85,\n      height: 85\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }), React.createElement(View, {\n    style: {\n      paddingLeft: 5\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, playlistDetail.name), React.createElement(Text, {\n    style: styles.description,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, playlistDetail.description))), React.createElement(ScrollView, {\n    style: styles.body,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, playlistDetail.tracks.items.map(function (item) {\n    var _item$track, _item$track$artists$;\n\n    return React.createElement(TouchableOpacity, {\n      key: item.track.id,\n      onPress: function onPress() {\n        setTrack(item.track);\n        loadAudio(item.track.preview_url);\n      },\n      style: styles.track,\n      disabled: !item.track.preview_url,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: \"#fff\",\n        opacity: item.track.preview_url ? 1 : 0.6\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    }, item.track.name), React.createElement(Text, {\n      style: {\n        color: \"lightgrey\",\n        opacity: item.track.preview_url ? 1 : 0.4,\n        fontSize: 10\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }\n    }, (_item$track = item.track) == null ? void 0 : (_item$track$artists$ = _item$track.artists[0]) == null ? void 0 : _item$track$artists$.name));\n  }))), track && React.createElement(View, {\n    style: styles.footer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.player,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.playerText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, track == null ? void 0 : track.name), React.createElement(Text, {\n    style: styles.playerAuthor,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, track == null ? void 0 : (_track$artists$ = track.artists[0]) == null ? void 0 : _track$artists$.name)), React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: styles.buttonPlayPause,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: audioState.isPlaying ? \"I I\" : \"▶️\",\n    color: \"#1DB954\",\n    onPress: handlePlayPause,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  })))));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#191414\"\n  },\n  header: {\n    height: \"20vh\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingLeft: 20,\n    backgroundColor: \"#1DB954\"\n  },\n  title: {\n    color: \"#fff\",\n    fontSize: 20,\n    fontWeight: \"bold\",\n    width: \"90%\"\n  },\n  description: {\n    color: \"#fff\",\n    fontSize: 12,\n    width: \"90%\"\n  },\n  body: {\n    height: \"70vh\",\n    overflow: \"hidden\",\n    paddingLeft: 20,\n    backgroundColor: \"#191414\"\n  },\n  track: {\n    marginTop: 5,\n    marginBottom: 5\n  },\n  footer: {\n    width: \"100%\",\n    height: 50,\n    backgroundColor: \"#191414\",\n    position: \"absolute\",\n    bottom: 0,\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    borderColor: \"#1DB954\",\n    borderTopWidth: 1\n  },\n  player: {\n    paddingLeft: 20\n  },\n  playerText: {\n    color: \"#fff\"\n  },\n  playerAuthor: {\n    color: \"#fff\",\n    fontSize: 10,\n    opacity: 0.7\n  },\n  buttonPlayPause: {\n    width: 50,\n    marginRight: 20,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["/Users/flo/Documents/Code/react-native/appstud/rn-appstud-test/screens/PlaylistDetailScreen.tsx"],"names":["React","axios","Audio","API_ENDPOINT","PlaylistDetailScreen","route","id","params","useState","playlistDetail","setPlaylistDetail","track","setTrack","isPlaying","playbackInstance","volume","isBuffering","audioState","setAudioState","useEffect","mounted","get","response","data","cleanup","loadAudio","soundUri","unloadAsync","Sound","loadAsync","uri","shouldPlay","console","log","handlePlayPause","pauseAsync","playAsync","styles","container","header","images","url","width","height","paddingLeft","title","name","description","body","tracks","items","map","item","preview_url","color","opacity","fontSize","artists","footer","player","playerText","playerAuthor","buttonPlayPause","StyleSheet","create","flex","backgroundColor","display","flexDirection","alignItems","fontWeight","overflow","marginTop","marginBottom","position","bottom","justifyContent","borderColor","borderTopWidth","marginRight"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport {\n  View,\n  ScrollView,\n  Text,\n  StyleSheet,\n  Image,\n  TouchableOpacity,\n  Button,\n} from \"react-native\";\nimport axios from \"axios\";\nimport { StackScreenProps } from \"@react-navigation/stack\";\nimport { PlaylistDetail, Item, Track } from \"../models/PlaylistDetail\";\nimport { Audio } from \"expo-av\";\n\nconst API_ENDPOINT = \"http://localhost:3001\";\n\ntype RootStackParamList = {\n  PlaylistDetail: { id: string };\n};\n\ntype AudioState = {\n  isPlaying: boolean;\n  playbackInstance: any;\n  volume: number;\n  isBuffering: boolean;\n};\n\ntype Props = StackScreenProps<RootStackParamList, \"PlaylistDetail\">;\n\nexport default function PlaylistDetailScreen({ route }: Props) {\n  const { id } = route.params;\n  const [playlistDetail, setPlaylistDetail] = React.useState<PlaylistDetail>();\n  const [track, setTrack] = React.useState<Track>();\n  const [audioState, setAudioState] = React.useState<AudioState>({\n    isPlaying: false,\n    playbackInstance: null,\n    volume: 1.0,\n    isBuffering: false,\n  });\n\n  React.useEffect(() => {\n    let mounted = true;\n    (async () => {\n      const response = await axios.get(`${API_ENDPOINT}/v1/playlists/${id}`);\n      setPlaylistDetail(response.data);\n    })();\n    return function cleanup() {\n      mounted = false;\n    };\n  }, []);\n\n  const loadAudio = async (soundUri: string) => {\n    if (!soundUri) return;\n    audioState?.playbackInstance &&\n      (await audioState?.playbackInstance.unloadAsync());\n\n    const playbackInstance = new Audio.Sound();\n    try {\n      await playbackInstance.loadAsync(\n        {\n          uri: soundUri,\n        },\n        {\n          shouldPlay: true,\n          volume: audioState.volume,\n        },\n        false\n      );\n      setAudioState({ ...audioState, playbackInstance, isPlaying: true });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const handlePlayPause = async () => {\n    console.log(\"audioState : \", audioState);\n    if (audioState?.playbackInstance) {\n      setAudioState({\n        ...audioState,\n        isPlaying: !audioState.isPlaying,\n      });\n      audioState.isPlaying\n        ? await audioState?.playbackInstance?.pauseAsync()\n        : await audioState?.playbackInstance?.playAsync();\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      {playlistDetail && (\n        <View>\n          <View style={styles.header}>\n            <Image\n              source={{ uri: playlistDetail.images[0].url }}\n              style={{ width: 85, height: 85 }}\n            />\n            <View style={{ paddingLeft: 5 }}>\n              <Text style={styles.title}>{playlistDetail.name}</Text>\n              <Text style={styles.description}>\n                {playlistDetail.description}\n              </Text>\n            </View>\n          </View>\n          <ScrollView style={styles.body}>\n            {playlistDetail.tracks.items.map((item: Item) => (\n              <TouchableOpacity\n                key={item.track.id}\n                onPress={() => {\n                  setTrack(item.track);\n                  loadAudio(item.track.preview_url);\n                }}\n                style={styles.track}\n                disabled={!item.track.preview_url}\n              >\n                <Text\n                  style={{\n                    color: \"#fff\",\n                    opacity: item.track.preview_url ? 1 : 0.6,\n                  }}\n                >\n                  {item.track.name}\n                </Text>\n                <Text\n                  style={{\n                    color: \"lightgrey\",\n                    opacity: item.track.preview_url ? 1 : 0.4,\n\n                    fontSize: 10,\n                  }}\n                >\n                  {item.track?.artists[0]?.name}\n                </Text>\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </View>\n      )}\n      {track && (\n        <View style={styles.footer}>\n          <View style={styles.player}>\n            <Text style={styles.playerText}>{track?.name}</Text>\n            <Text style={styles.playerAuthor}>{track?.artists[0]?.name}</Text>\n          </View>\n          <View>\n            <View style={styles.buttonPlayPause}>\n              <Button\n                title={audioState.isPlaying ? \"I I\" : \"▶️\"}\n                color=\"#1DB954\"\n                onPress={handlePlayPause}\n              />\n            </View>\n          </View>\n        </View>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#191414\",\n  },\n  header: {\n    height: \"20vh\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingLeft: 20,\n    backgroundColor: \"#1DB954\",\n  },\n  title: {\n    color: \"#fff\",\n    fontSize: 20,\n    fontWeight: \"bold\",\n    width: \"90%\",\n  },\n  description: {\n    color: \"#fff\",\n    fontSize: 12,\n    width: \"90%\",\n  },\n  body: {\n    height: \"70vh\",\n    overflow: \"hidden\",\n    paddingLeft: 20,\n    backgroundColor: \"#191414\",\n  },\n  track: {\n    marginTop: 5,\n    marginBottom: 5,\n  },\n  footer: {\n    width: \"100%\",\n    height: 50,\n    backgroundColor: \"#191414\",\n    position: \"absolute\",\n    bottom: 0,\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    borderColor: \"#1DB954\",\n    borderTopWidth: 1,\n  },\n  player: {\n    paddingLeft: 20,\n  },\n  playerText: {\n    color: \"#fff\",\n  },\n  playerAuthor: {\n    color: \"#fff\",\n    fontSize: 10,\n    opacity: 0.7,\n  },\n  buttonPlayPause: {\n    width: 50,\n    marginRight: 20,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\n"]},"metadata":{},"sourceType":"module"}